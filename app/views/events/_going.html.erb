<div id="going">
  <% attending = Attending.yes.where(event: @event) %>
  <% not_attending = Attending.no.where(event: @event) %>
  <% indecisive = Attending.maybe.where(event: @event) %>
  <p>
    <%= attending.count %> going | <%= not_attending.count %> not going | <%= indecisive.count %> maybe
  </p>

  <% if user_signed_in? %>
    <p>
      <% attend = Attending.find_by(event: @event, user: current_user) %>
      <% if attend.nil? %>
        Going? <%= link_to 'Yes', event_going_path(@event), method: :put, remote: true %>
             | <%= link_to 'No', event_not_going_path(@event), method: :put, remote: true  %>
             | <%= link_to 'Maybe', event_maybe_path(@event), method: :put, remote: true %>
      <% elsif attend.yes? %>
        You are going!
        <p>
        Changed your mind? <%= link_to 'Not going', event_not_going_path(@event), method: :put, remote: true  %>
                         | <%= link_to 'Maybe i\'ll go', event_maybe_path(@event), method: :put, remote: true %>
        </p>
      <% elsif attend.no? %>
        You are not going.
        <p>
          Changed your mind? <%= link_to 'Yes', event_going_path(@event), method: :put, remote: true  %>
                           | <%= link_to 'Maybe i\'ll go', event_maybe_path(@event), method: :put, remote: true %>
        </p>
      <% else %>
        You are indecisive.
        <p>
          Going? <%= link_to 'Yes', event_going_path(@event), method: :put, remote: true  %>
               | <%= link_to 'No', event_not_going_path(@event), method: :put, remote: true %>
        </p>
      <% end %>
    </p>
  <% end %>

  <% unless attending.empty? %>
    <strong>Going:</strong>
    <% attending.each do |a| %>
      <p><%= a.user.name %></p>
    <% end %>
  <% end %>

  <% unless not_attending.empty? %>
    <strong>Not going:</strong>
    <% not_attending.each do |a| %>
      <p><%= a.user.name %></p>
    <% end %>
  <% end %>

  <% unless indecisive.empty? %>
    <strong>Indecisive:</strong>
    <% indecisive.each do |a| %>
      <p><%= a.user.name %></p>
    <% end %>
  <% end %>
    
</div>